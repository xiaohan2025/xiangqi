<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#121212" />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600&family=Space+Grotesk:wght@400;600&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="styles.css?v=7" />
  <title>象棋对弈辅助</title>
</head>

<body>
  <div class="app">
    <header class="app-header">
      <h1>中国象棋辅助工具</h1>
    </header>

    <main class="layout">
      <!-- 手机端：切换按钮放在棋盘上方 -->
      <div class="mobile-toggle-area">
        <div class="toggle-group">
          <button id="mobileStartRed" class="btn toggle active">我先走</button>
          <button id="mobileStartBlack" class="btn toggle">对方先走</button>
        </div>
      </div>

      <section class="board-wrap">
        <div id="board" class="board">
          <svg class="board-grid" viewBox="0 0 900 1000" aria-hidden="true">
            <!-- 背景设为透明，显示 CSS 背景 -->
            <rect x="0" y="0" width="900" height="1000" rx="20" fill="transparent" />
            <g class="grid-lines" stroke="rgba(212, 175, 55, 0.4)" stroke-width="2">
              <!-- Horizontal Lines -->
              <line x1="50" y1="50" x2="850" y2="50" />
              <line x1="50" y1="150" x2="850" y2="150" />
              <line x1="50" y1="250" x2="850" y2="250" />
              <line x1="50" y1="350" x2="850" y2="350" />
              <line x1="50" y1="450" x2="850" y2="450" />
              <line x1="50" y1="550" x2="850" y2="550" />
              <line x1="50" y1="650" x2="850" y2="650" />
              <line x1="50" y1="750" x2="850" y2="750" />
              <line x1="50" y1="850" x2="850" y2="850" />
              <line x1="50" y1="950" x2="850" y2="950" />

              <!-- Vertical Lines (Outer) -->
              <line x1="50" y1="50" x2="50" y2="950" />
              <line x1="850" y1="50" x2="850" y2="950" />

              <!-- Vertical Lines (Inner Top) -->
              <line x1="150" y1="50" x2="150" y2="450" />
              <line x1="250" y1="50" x2="250" y2="450" />
              <line x1="350" y1="50" x2="350" y2="450" />
              <line x1="450" y1="50" x2="450" y2="450" />
              <line x1="550" y1="50" x2="550" y2="450" />
              <line x1="650" y1="50" x2="650" y2="450" />
              <line x1="750" y1="50" x2="750" y2="450" />

              <!-- Vertical Lines (Inner Bottom) -->
              <line x1="150" y1="550" x2="150" y2="950" />
              <line x1="250" y1="550" x2="250" y2="950" />
              <line x1="350" y1="550" x2="350" y2="950" />
              <line x1="450" y1="550" x2="450" y2="950" />
              <line x1="550" y1="550" x2="550" y2="950" />
              <line x1="650" y1="550" x2="650" y2="950" />
              <line x1="750" y1="550" x2="750" y2="950" />

              <!-- Diagonals -->
              <line x1="350" y1="50" x2="550" y2="250" />
              <line x1="550" y1="50" x2="350" y2="250" />
              <line x1="350" y1="750" x2="550" y2="950" />
              <line x1="550" y1="750" x2="350" y2="950" />
            </g>
            <g class="river">
              <text x="250" y="500" class="river-text" fill="rgba(212, 175, 55, 0.3)" font-family="'KaiTi', serif"
                font-weight="bold" letter-spacing="10">楚 河</text>
              <text x="650" y="500" class="river-text" fill="rgba(212, 175, 55, 0.3)" font-family="'KaiTi', serif"
                font-weight="bold" letter-spacing="10">漢 界</text>
            </g>
          </svg>
          <svg class="board-overlay" viewBox="0 0 900 1000" aria-hidden="true">
            <defs>
              <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6"
                orient="auto-start-reverse">
                <path d="M 0 0 L 10 5 L 0 10 z" />
              </marker>
            </defs>
            <line id="lastMoveArrow" x1="0" y1="0" x2="0" y2="0" marker-end="url(#arrow)" />
          </svg>
        </div>
      </section>

      <aside class="panel">
        <!-- 电脑端：切换按钮 -->
        <div class="panel-section desktop-toggle">
          <label class="section-label">谁先走?</label>
          <div class="toggle-group">
            <button id="startRed" class="btn toggle active">我先走</button>
            <button id="startBlack" class="btn toggle">对方先走</button>
          </div>
          <p class="subtext">你执红方，对方执黑方</p>
        </div>

        <!-- 合并：状态 + AI建议 + AI按钮 -->
        <div class="panel-section status-ai-combined">
          <div class="status-row">
            <span class="status-label">当前状态：</span>
            <span id="statusText">红方走棋</span>
            <button id="aiMove" class="ai-icon-btn" title="AI 帮我走">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10" />
                <path d="M12 6v6l4 2" />
              </svg>
            </button>
          </div>
          <div class="ai-row">
            <span id="suggestion">AI 建议：等待分析...</span>
          </div>
        </div>

        <div class="panel-section">
          <label class="section-label">局面评估</label>
          <div class="winrate-container">
            <div class="bar">
              <div id="redBar" class="bar-fill" style="width: 50%"></div>
            </div>
            <div id="winrateLabel" class="winrate-text">红方 50% &nbsp; 黑方 50%</div>
          </div>
        </div>

        <!-- AI 风格切换 -->
        <div class="panel-section">
          <label class="section-label">AI 风格</label>
          <div class="toggle-group style-toggle">
            <button id="styleAggressive" class="btn toggle active" title="激进速杀">⚔️ 激进</button>
            <button id="styleBalanced" class="btn toggle" title="攻守兼备">⚖️ 平衡</button>
            <button id="styleDefensive" class="btn toggle" title="稳扎稳打">🛡️ 稳健</button>
          </div>
        </div>

        <div class="action-buttons">
          <button id="restartBtn" class="btn primary large">重新开始</button>
          <button id="undo" class="btn secondary">悔棋</button>
        </div>
  </div>

  <div id="engineStatus" class="engine-status-tiny">引擎状态：初始化中</div>
  </aside>
  </main>
  </div>

  <script src="app.js?v=6" defer></script>
</body>

</html>